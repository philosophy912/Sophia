------

# 自动化代码生成工具

------

### 工具说明



本工具适用于：

- 高通虚拟化方案的中控+仪表测试（依赖于开发提供**Htalk**命令)
- QNX空调屏测试（依赖于开发提供的**InjectEvents**进行屏幕操作)
- 单仪表测试
- 仅HMI仪表测试用例生成（依赖于开发提供的test文件)
- 单安卓测试

#### 环境依赖

java只支持jdk_1.8

#### 工具包含：

- code-x.x.jar
- templates
  - __ init __.py
  - action.ftlh
  - compare.ftlh
  - config.ftlh
  - context.ftlh
  - testcase.ftlh



#### 使用方法：

- ```shell
  // 当前执行的文件夹下不存在file文件夹
  java -jar code-x.x.jar // 会在当前目录下生成template.xls文件
  ```

  

- ```shell
  // 当前文件夹下存在file文件夹且该文件夹中存在testcase.xls或者testcase.xlsx文件
  java -jar code-x.x.jar // 会根据testcase中描述的信息生成测试代码
  ```

- ```
  // 此时会在当前路径下寻找excel所描述的dbc文件，并生成测试代码
  java -jar code-x.x.jar yy.xlsx
  java -jar code-x.x.jar yy.xls
  ```



#### 模板文件内容填写说明

- **电源操作(BatteryAction)**

  主要是针对电源相关的操作

  | Id<br/>序号                           | 序号，主要用于定位错误                                       |
  | ------------------------------------- | ------------------------------------------------------------ |
  | Name<br/>名字/函数名/模块名           | 函数名，必须符合python的函数名规则，建议仅保留下划线和字母数字，去掉其他符号。<br/>软件支持自动将空格转换成_用于检查和代码生成，但仍然建议手动完成相关操作 |
  | Comments<br/>描述                     | 该操作的简要描述                                             |
  | BatteryType<br/>电源类型              | 下拉菜单，仅支持**IT6831**和**KONSTANTER**，请不要修改相关的文字 |
  | BatteryOperationType<br/>电源操作类型 | 下拉菜单，仅支持【设置电压/设置电流/调节电压/电压曲线】，请不要修改相关的文字 |
  | Values<br/>电源操作值                 | 若设置电压/电流值，则填写数值12.1/10<br/>若调节电压，则值设置成12-18-0.1-5，代表意思是从12V调节到18V，步长0.1V，每次调节间隔时间5秒<br/>若电压曲线，该操作值可以不用填写 |
  | RepeatTimes<br/>重复次数              | 反复执行的次数，需要手动填写次数，无默认值                   |
  | CurveFile<br/>电压曲线文件            | 电压曲线文件，需要填写该文件的绝对路径                       |

- **Can信号(CanAction)**

    主要针对CAN消息的发送操作
    
    | Id<br/>序号                 | 序号，主要用于定位错误                                       |
    | --------------------------- | ------------------------------------------------------------ |
    | Name<br/>名字/函数名/模块名 | 函数名，必须符合python的函数名规则，建议仅保留下划线和字母数字，去掉其他符号。<br/>软件支持自动将空格转换成_用于检查和代码生成，但仍然建议手动完成相关操作 |
    | Comments<br/>描述           | 该操作的简要描述                                             |
    | Signals<br/>信号名与值      | CAN消息中的Signal的名称和值的对应关系，以**=**分割，可以填写一个或者多个信号<br/>如：iBCM_FL_DoorAjarSts=0x1<br/>或者：PBD_RearDoorStatus=0x0<br/>PBD_RearDoorStsVld=0x0<br>左边部分代表信号的名称，该名称必须要在Sheet【配置(Configure)】中指定的DBC中有相关的描述信息<br>右边部分代表信号的值，该值必须满足总线值的范围，即根据信号长度计算出来的最小值和最大值。 |

- 元素操作(ElementAction)

  主要针对Android元素的相关操作

  | Id<br/>序号                      | 序号，主要用于定位错误                                       |
  | -------------------------------- | ------------------------------------------------------------ |
  | Name<br/>名字/函数名/模块名      | 函数名，必须符合python的函数名规则，建议仅保留下划线和字母数字，去掉其他符号。<br/>软件支持自动将空格转换成_用于检查和代码生成，但仍然建议手动完成相关操作 |
  | Comments<br/>描述                | 该操作的简要描述                                             |
  | OperationActionType<br/>操作类型 | 下拉菜单， 仅支持【滑动/点击/长按/双击/上下左右滑动/上下左右滑动到底】， 请不要修改相关的文字<br>滑动：表示从某个安卓元素滑动到另外一个安卓元素，要求元素名中的元素为两行，表示两个定位的点<br>上下左右滑动/滑动到底: 表示在某个滑动列表中滑动，要求元素名中的元素为两行，第一行表示滑动列表的定位，第二行表示显示的列表（Item) |
  | Elements<br/>元素名              | 元素的名称，该名称必须要在Sheet【安卓元素(Element)】中能查询到<br> |
  | SlideTimes<br/>滑动次数/持续时间 | 若操作类型不是滑动，则无需填写该项目。<br>该表格中表示持续时间而非次数 |

- 继电器操作(RelayAction)

  | Id<br/>序号                           | 序号，主要用于定位错误                                       |
  | ------------------------------------- | ------------------------------------------------------------ |
  | Name<br/>名字/函数名/模块名           | 函数名，必须符合python的函数名规则，建议仅保留下划线和字母数字，去掉其他符号。<br/>软件支持自动将空格转换成_用于检查和代码生成，但仍然建议手动完成相关操作 |
  | Comments<br/>描述                     | 该操作的简要描述                                             |
  | RelayOperationType<br/>继电器操作类型 | 下拉菜单，仅支持【开启/关闭/全开/全关】操作，请不要修改相关的文字<br> |
  | ChannelIndex<br/>继电器通道           | 需要开启或者关闭的通道号，生成代码的时候无法校验是否填写正确<br>但如果填写错误会导致运行时候报错<br>若选择全开或者全关操作，则无需填写通道号码 |

- 屏幕操作(ScreenOpsAction)

  | Id<br/>序号                      | 序号，主要用于定位错误                                       |
  | -------------------------------- | ------------------------------------------------------------ |
  | Name<br/>名字/函数名/模块名      | 函数名，必须符合python的函数名规则，建议仅保留下划线和字母数字，去掉其他符号。<br/>软件支持自动将空格转换成_用于检查和代码生成，但仍然建议手动完成相关操作 |
  | Comments<br/>描述                | 该操作的简要描述                                             |
  | DeviceType<br/>屏幕类型          | 下拉菜单，仅支持【】                                         |
  | ScreenOperationType<br/>操作类型 |                                                              |
  | ScreenIndex<br/>屏幕序号         |                                                              |
  | Points<br/>坐标点                |                                                              |
  | ContinueTimes<br/>持续时间       |                                                              |

  



